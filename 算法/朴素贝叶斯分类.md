### 朴素贝叶斯分类
#### 贝叶斯原理
*逆向概率：通过某出来的球的颜色（黑白）推断袋子中黑白球的比例。*
* **先验概率**：通过经验判断事情发生的概率。
  * 如：某病的发病概率为万分之一。


* **后验概率**：发生结果后，推测原因的概率。
  * 如：检车某人患有某病，患病原因可能为 A B C，患病原因为 A 的概率就是后验概率。
  * 条件概率的一种。


* **条件概率**：事件 B 已经发生的条件下，事件 A 发生的概率。记作 P(A|B)
  * 如：原因 A 条件下，患病的概率。

* **似然函数(likelihood function)**
  * 如：抛一枚硬币连续 10 次正面朝上，求硬币均匀的可能性。硬币均匀为参数，似然函数用来衡量这个模型的参数。
  * 用于在已知某些观测所得到的结果时，对有关事物的性质的参数进行估计。

#### 通用的贝叶斯公式
![](https://github.com/YubinLiu/GeekTime_DataAnalysis/tree/master/img/通用贝叶斯公式.png)

***

#### 朴素贝叶斯
* 假定每个输入变量独立。
* 朴素贝叶斯模型由两种类型的概率组成。
  * 每个类别的概率 P(Cj)
  * 每个属性的条件概率 P(Ai|Cj)

**举例**：7 个球，3 白 4 黑
* 类别概率：球是白色的概率 3/7，球是黑色的概率 4/7。
* 条件概率：球放两个盒子，A 中 2 白 2 黑，B 中 1 白 2 黑。A 中抓到白球的概率 1/2，抓到黑球的概率 1/2。即在某个条件（如从 A 盒中抓取）的概率。

#### 朴素贝叶斯分类工作原理
**离散数据案例**
* 数据：\
![](https://github.com/YubinLiu/GeekTime_DataAnalysis/tree/master/img/男女离散数据.png)
* 问题：身高“高”、体重“中”，鞋码“中”，请问这个人是男还是女？
* 解：
  * A 代表属性，A1，A2，A3 -> 身高=高，体重=中，鞋码=中。
  * C 代表类别，C1，C2 -> 男，女
  * 求 A1、A2、A3 属性下，Cj的概率 \
  ![](https://github.com/YubinLiu/GeekTime_DataAnalysis/tree/master/img/男女概率公式.png)
  * 假定 Ai 之间相互独立：P(A1A2A3|Cj) = P(A1|Cj)P(A2|Cj)P(A3|Cj)
  * P(A1|C1) = 1/2; P(A2|C1) = 1/2; P(A3|C1) = 1/4; P(C1) = 1/2
  * P(A1|C2) = 0; P(A2|C2) = 1/2; P(A3|C2) = 1/2; P(C2) = 1/2
  * P(A1A2A3|C1)P(C1) > P(A1A2A3|C2)P(C2)，C1 类别，男。

**连续数据案例**
* 数据：\
![](https://github.com/YubinLiu/GeekTime_DataAnalysis/tree/master/img/男女连续数据.png)
* 问题：身高 180、体重 120，鞋码 41，请问该人是男是女呢？
* 解：
  * 假定属性为正态分布，通过样本计算均值和方差，得到正态分布的密度函数。
  * 根据密度函数算出某一点的密度函数值，如：男性身高均值 179.5，标准差 3.967 的正态分布。
  * EXCEL 的 NORMDIST(x,mean,standard_dev,cumulative) 函数
    * x：正态分布中需要计算的数值
    * mean：正态分布的平均值
    * standard_dev：正态分布的标准差
    * cumulative：True-累积分布/False-概率密度
    * 男性身高 180 的概率：NORMDIST(180,179.5,3.697,0)=0.1069
    * 男性体重 120 的概率：0.000382324
    * 男性鞋码 41 的概率：0.120304111
  * 计算乘积后与女性相关数据比较，得出分类为 男 的概率大。

#### 朴素贝叶斯分类器的三个流程
1. 准备阶段：确定特征属性，获取训练样本。
2. 训练阶段：计算每个类别在训练样本中的出现频率，对每个特征属性计算所有划分的条件概率。
  * 输入特征属性和训练样本，输出分类器。
3. 应用阶段：利用分类器对新数据进行分类。
